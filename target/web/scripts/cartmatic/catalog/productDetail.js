$(document).ready(function(){fnChangePrice()});var dlgReview=null;function addReviewAction(a){var b=function(){var c=getCurrentUserId();if(dlgReview==null){dlgReview=fnCreateSimpleDialog("Review",__FMT.add_Review,null,{dialogWidth:"520px",dialogHeight:"350px"})}dlgReview.showDialog(__ctxPath+"/review/write/"+$("#productId").val()+".html?decorator=blank")};if(a){b.call()}else{doRequiredLoginAction(b)}}function doReviewAction(b,a){if(!validateProductReviewForm(b)){}else{var c=function(){var d=$("#productReviewForm").serialize();$.post("/review/write/"+$("#productId").val()+".html",d,fndoReviewAction,"json")};if(a){c.call()}else{doRequiredLoginAction(c)}}}function fndoReviewAction(a){if(a.action==1){if(dlgReview!=null){dlgReview.closeDialog()}if($("#productReviewForm")){$("#productReviewForm").get(0).reset()}alert(__FMT.product_addReview_success);fnGetProductReviewList($("#productId").val())}else{alert("ERROR!")}}function fnGetProductReviewList(c,d){var a=__ctxPath+"/review/product/"+c+".html";var b="template=review/include/productReviewListContent&decorator=blank";if(d){b+="&PrmPageNo="+d}fillDivWithPage("productReviewContent",a,b,null,"get",true)}function validateProductReviewForm(a){if(__fnIsEmptyOrOverMaxLength(a.productReview_username,__FMT.productReview_username_required)){}else{if(__fnIsEmptyOrOverMaxLength(a.subject,__FMT.productReview_subject_required,128,__FMT.productReview_subject_maxlength)){}else{if(__fnIsEmptyOrOverMaxLength(a.message,__FMT.productReview_message_required,1024,__FMT.productReview_message_maxlength)){}else{return true}}}return false}function fnChooseStar(a,b){$("#rate_"+a).val(a+"_"+b);$("#star_"+a).html(b);var d=b;for(var c=1;c<=5;c++){if(c<=d){$("#star_"+a+"_"+c).attr("class","star")}else{$("#star_"+a+"_"+c).attr("class","star-gray")}}}function fnVote(a,b){doRequiredLoginAction(function(){if(!isLoginedAtServer()){window.location.reload();return}$.post("/review/vote/"+a+".html",{voteFlag:b},function(c){var d=$("#info_"+a);if(c.status==1){d.removeClass("cRed").addClass("cGreen").html(__FMT.productReview_voteSuccess)}else{if(c.status==2){d.removeClass("cRed").addClass("cGreen").html(__FMT.productReview_isVoted)}else{if(c.status==3){d.removeClass("cGreen").addClass("cRed").html(__FMT.productReview_isSelfReview)}else{if(c.status==-500){alert("系统错误了!")}}}}},"json")})}function fnVoteCallback(a){var b=$("#info_"+reviewId);if(a.status==1){b.removeClass("cRed").addClass("cGreen").html(__FMT.productReview_voteSuccess)}else{if(a.status==2){b.removeClass("cRed").addClass("cGreen").html(__FMT.productReview_isVoted)}else{if(a.status==3){b.removeClass("cGreen").addClass("cRed").html(__FMT.productReview_isSelfReview)}}}}function fnGetSelectedCheckBoxValues(d){var a=new Array();var c=document.getElementsByName(d);if(c){for(var b=0;b<c.length;b++){if(c[b].checked){a.push(c[b].value)}}}return a.join(",")}function __fnIsEmptyOrOverMaxLength(b,d,a,c){if(b.value==null||b.value.trim()==""){alert(d);b.focus();return true}else{if(a&&c){return __fnIsOverMaxLength(b,a,c)}}return false}function __fnIsOverMaxLength(b,a,c){if(b.value.length>a){alert(c);b.focus();return true}return false}function __fnIsErrorEmail(a,b){if(!fnValidateEmail(a.value)){alert(b);a.focus();return true}return false}var productFlashBox=new Array();var productFlashBox_pageSize=10;var productFlashBox_pageCount=0;var productFlashBox_pageNum=1;var productFlashBox_productCount=0;function initProductFlashBox(d){productFlashBox=d;productFlashBox_productCount=productFlashBox.length;productFlashBox_pageCount=Math.floor((productFlashBox_productCount/productFlashBox_pageSize))+((productFlashBox_productCount%productFlashBox_pageSize==0)?0:1);var c=$("#productId").val();var b=1;for(var a=0;a<productFlashBox_productCount;a++){if(a>(b*productFlashBox_pageSize)){b++}if(productFlashBox[a].productId==c){productFlashBox_pageNum=b}}showProductFlashBox()}function showProductFlashBox(){if($("#productFlashBoxContent_Page")){$("#productFlashBoxContent_Page").html(productFlashBox_pageNum+"/"+productFlashBox_pageCount);var b=(productFlashBox_pageNum-1)*productFlashBox_pageSize;if(b>0){b-1}var a=b+productFlashBox_pageSize;var e="<ul>";var d=$("#productId").val();for(var c=b;c<a;c++){if(c<productFlashBox_productCount){if(productFlashBox[c].productId==d){e+='<li class="selected">'}else{e+="<li>"}e+='<a href="'+productFlashBox[c].url+'" title="'+productFlashBox[c].productName.replace(/"/g,"&quot;")+'"><img width="72" height="72" src="'+__mediaPath+"product/b/"+(productFlashBox[c].image)+'" /></a><br/>'+__defaultCurrencySymbol+(productFlashBox[c].price)+"</li>"}else{e+="<li>&nbsp;</li>"}}e+="</ul>";$("#productFlashBoxContent").html(e);fnLoadingImg()}}function movePR(){productFlashBox_pageNum++;if(productFlashBox_pageNum>productFlashBox_pageCount){productFlashBox_pageNum=1}showProductFlashBox()}function movePL(){productFlashBox_pageNum--;if(productFlashBox_pageNum<1){productFlashBox_pageNum=productFlashBox_pageCount}showProductFlashBox()}function fnChangePrice(){var h=$("#quantity").val();if(h){var f;var c=0;var g=$("select[name='accessory']");for(var e=0;e<g.length;e++){var d=$(g[e]).children(":selected");if(parseFloat(d.attr("price"))>0){c+=parseFloat(d.attr("price"))}}var b=$("#priceViewType").val();for(var e=skuWholesalePrices.length-1;e>=0;e--){if(h>=parseInt(skuWholesalePrices[e][0])){f=(parseFloat(skuWholesalePrices[e][1])+c)*h;if(b==2||b==3){$("#salesPriceSpan").html(__defaultCurrencySymbol+(parseFloat(skuWholesalePrices[e][1])+c).toFixed(2))}else{$("#priceSpan").html(__defaultCurrencySymbol+(parseFloat(skuWholesalePrices[e][1])+c).toFixed(2));if($("#savedSpan")){var a=$("#listPrice").val();$("#savedSpan").html("&nbsp;"+__defaultCurrencySymbol+(a-(parseFloat(skuWholesalePrices[e][1])+c)).toFixed(2)+"&nbsp;("+((a-(parseFloat(skuWholesalePrices[e][1])+c))/a*100).toFixed(0)+"%)")}$("#products_price_all").html(__defaultCurrencySymbol+f.toFixed(2))}break}}}}$("select[name='accessory']").change(fnChangePrice);function checkAddProductToCart(){var a=true;if($("#productSkuCode").val()==""){alert(undeterminedAttributes+__FMT.unselected+"!");a=false}if(a&&$("select[name='accessory']").length>0){var e=$("select[name='accessory']");var d="";var c="";for(var b=0;b<e.length;b++){if($(e[b]).val()==0){if(d!=""){d+=" and "}d+=$(e[b]).attr("accessoryName")}else{if(c!=""){c+=","}c+=$(e[b]).val()}}if(d!=""){d="Please Select "+d;alert(d);a=false}else{$("#selectAccessorys").val(c);a=true}}if(a&&(parseInt($("#quantity").val())<parseInt($("#minOrderQuantity").val()))){a=false;alert("Starting from:"+$("#minOrderQuantity").val()+" Unit(s).")}return a}function fnChangeProdImg(c,d,g,e){c.addClass("selected").siblings().removeClass("selected");var f=d.attr("src").replace("/"+g+"/","/"+e+"/");$("#productImg").attr("src",__resPath+"/images/img/empty.gif");var b=document.createElement("IMG");b.src=f;b.onload=function(){$("#productImg").attr("src",f)}}if($("#imgPageCount")){var imgPageCount=$("#imgPageCount").val();var imgOnePageLenght=265;var imgMaxLenght=imgPageCount*imgOnePageLenght;var imgPageNum=1}function moveR(){imgPageNum++;var b=imgPageNum-1;var a=b*imgOnePageLenght;if(a>=imgMaxLenght){$("#imgContent").css("left",0+"px");imgPageNum=1}else{$("#imgContent").css("left",-a+"px")}$("#imgPageShow").html(imgPageNum+"/"+imgPageCount)}function moveL(){imgPageNum--;var b=imgPageNum-1;var a=b*imgOnePageLenght;if(a<0){$("#imgContent").css("left",-(imgMaxLenght-imgOnePageLenght)+"px");imgPageNum=imgPageCount}else{$("#imgContent").css("left",-a+"px")}$("#imgPageShow").html(imgPageNum+"/"+imgPageCount)}jQuery.fn.loadingImg=function(e){if(e.complete){return}var c=e.src;var a=e.getAttribute("width");var d=e.getAttribute("height");var a=e.getAttribute("width");var d=e.getAttribute("height");if(a){$(e).attr("width",a)}if(d){$(e).attr("height",d)}$(e).attr({src:__ctxPath+"/images/img/imgBox_s.gif"});$(e).css("background","url("+__ctxPath+"/images/img/loading_img_s.gif) 50% 50% no-repeat");var b=new Image();$(b).attr("t",1);$(b).load(function(){var f=function(){if(b.complete){$(e).attr("src",c)}else{var g=parseInt($(b).attr("t"));if(g<=3){g++;$(b).attr("t",g);setTimeout(f,100)}else{$(e).attr({src:__ctxPath+"/images/default/00.jpg",originsrc:c})}}};f.call()});$(b).error(function(){$(e).attr({src:__ctxPath+"/images/default/00.jpg",originsrc:c})});b.src=c};function fnLoadingImg(){$("img[src*='/media/'][src$='.jpg'],img[src*='/media/'][src$='.gif'],img[src*='/media/'][src$='/']").each(function(){$(this).loadingImg(this)})}function popupwin(d,c,e,a,b){if($.browser.msie){var f=window.showModelessDialog(d,window,"status:false;dialogWidth:"+(e)+"px;dialogHeight:"+(a+30)+"px;edge:Raised; help: 0; resizable: 0; status: 0;scroll:0;")}else{xposition=0;yposition=0;if((parseInt(navigator.appVersion)>=4)){xposition=(screen.width-e)/2;yposition=(screen.height-a)/2}theproperty="width="+e+",height="+a+",screenx="+xposition+",screeny="+yposition+",left="+xposition+",top="+yposition+","+b;var f=window.open(d,c,theproperty);f.focus()}return false}var dlgInquiry=null;var dlgInquiry_r="";function fnShowInquiryDialog(){if(dlgInquiry==null){$.getScript(__ctxPath+"/scripts/jquery/plugins/validation/jquery.validate.js",function(){dlgInquiry=fnCreateSimpleDialog("Inquiry","",null,{dialogWidth:"400px",dialogHeight:"180px"});dlgInquiry.showDialog(__ctxPath+"/inquiry.html?decorator=blank&"+dlgInquiry_r)})}else{dlgInquiry.showDialog(__ctxPath+"/inquiry.html?decorator=blank&"+dlgInquiry_r)}}function showBox(c){var a=["payment_option","shipping_info","costs_info"];for(var b=0;b<a.length;b++){if(a[b]==c){$("#"+a[b]).show()}else{$("#"+a[b]).hide()}}};