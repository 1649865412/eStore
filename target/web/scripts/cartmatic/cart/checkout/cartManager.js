function fnUseGift(c,b){if(b==1){if($("#giftCertificateNo").val()==""){$.post(__ctxPath+"/checkout/paymentProcess.html?doAction=notuseGc",{giftCertificateNo:c},function(d){var e=parseFloat("0.0");$("#giftPay").text(e.toFixed(2));$("#couponNo_input_id").attr("disabled",false);fnUpdatePrice()},"json")}if(c==$("#giftCertificateNo").val()){return false}else{c=$("#giftCertificateNo").val();var a=parseFloat($("#cart_sum").text());$.post(__ctxPath+"/checkout/paymentProcess.html?doAction=doUseGc",{giftCertificateNo:c,money:a},function(e){if(e.status==1){var g=c;var f=e.data;var d=parseFloat($("#giftPay").text());$("#giftPay").text(f.toFixed(2));$("#couponNo_input_id").attr("disabled",true)}else{alert(e.msg);$("#giftPay").text("0.00");$("#couponNo_input_id").attr("disabled",false)}fnUpdatePrice()},"json")}}if(b==2){if(c==$("#giftCertificateNo").val()){return false}else{$("#giftCertificateNo").val(c);var a=parseFloat($("#cart_sum").text());$.post(__ctxPath+"/checkout/paymentProcess.html?doAction=doUseGc",{giftCertificateNo:$("#giftCertificateNo").val(),money:a},function(e){if(e.status==1){var h=c;var g=e.data;var d=parseFloat($("#giftPay").text());$("#giftPay").text(g.toFixed(2));var f=$("#giftCertificateNos").val();if(f!=""){f+="#"}f+=h+":"+g;$("#giftCertificateNos").val(f);$("#giftCertificate").val(true);$("#giftCertificateNo").val(c);$("#couponNo_input_id").attr("disabled",true)}else{alert(e.msg);$("#giftPay").text("0.00");$("#couponNo_input_id").attr("disabled",false)}fnUpdatePrice()},"json")}hideTemlateList()}}function fnUseCoupon(b){if($("#couponNo_input_id").val()==b){return false}else{if($("#couponNo_input_id").val()==""){$.post(__ctxPath+"/cart/shoppingcart.html?doAction=notuseCoupon",{couponNo_input_name:$("#couponNo_input_id").val()},function(c){var d=parseFloat($("#cart_dis_member").val());$("#cartDiscountAmount").text("0.00");$("#giftCertificateNo").attr("disabled",false);fnUpdatePrice()},"json")}else{var a=parseFloat($("#cart_dis_member").val());$.post(__ctxPath+"/cart/shoppingcart.html?doAction=useCoupon",{couponNo_input_name:$("#couponNo_input_id").val()},function(c){var e=0;if(c.status==1){var d=c.data;$("#cartDiscountAmount").text((d).toFixed(2));e=parseFloat($("#cartDiscountAmount").text());$("#giftCertificateNo").attr("disabled",true)}else{alert(c.msg);e=c.data;$("#cartDiscountAmount").text("0.00");$("#cart_dis_member").val(e);$("#giftCertificateNo").attr("disabled",false)}fnUpdatePrice()},"json")}}}function fnUpdatePrice(){var c=parseFloat($("#cart_sum_prev").val());var d=parseFloat($("#cart_dis_member").text());var f=parseFloat($("#cartDiscountAmount").text());var a=parseFloat($("#giftPay").text());var e=parseFloat($("#shopPointMoney").text());var b=parseFloat(c-d-f-a-e).toFixed(2);$("#cart_sum").text(b<0?"0.00":b);if(b<300){$("#selectbasic").attr("disabled",true)}else{$("#selectbasic").attr("disabled",false)}}function showGiftList(){var b=$("#giftCertificateNo");var a=b.offset();$("#giftList").css({left:a.left+"px",top:a.top+b.outerHeight()+"px"}).slideDown("fast");$("body").bind("mousedown",onBodyDown)}function hideTemlateList(){$("#giftList").fadeOut("fast");$("body").unbind("mousedown",onBodyDown)}function onBodyDown(a){if(!(a.target.id=="giftList"||$(a.target).parents("#giftList").length>0)){hideTemlateList()}}function substractQuantity(c){var b=$(c);var a=b.next();if(parseInt(a.val())!=1){a.val(parseInt(a.val())-1)}}function addQuantity(c){var b=$(c);var a=b.prev();a.val(parseInt(a.val())+1)}function fnSelectChangeGift(c){var b="${appConfig.shopPointUseGiftPercent}";var a=(b*c).toFixed(2);$("#shopPointMoney").text(a);fnUpdatePrice();$.post(__ctxPath+"/checkout/paymentProcess.html?doAction=doUseShopPoint",{selectPoint:c},function(d){},"json")};